<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using GPE • GPE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using GPE">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GPE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/using_GPE.html">Using GPE</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Using GPE</h1>
            
      
      
      <div class="hidden name"><code>using_GPE.Rmd</code></div>

    </div>

    
    
<div id="prerequisites" class="section level2">
<h2 class="hasAnchor">
<a href="#prerequisites" class="anchor"></a>Prerequisites</h2>
<p>You’ll need tabular data with addresses, or “lon” and “lat” columns containing WG84 (Mercator) location coordinates. IE, a table with the addresses of schools were program beneficiaries attend, or a street or centroid identifying their neighboorhoods, or their home addresses -if using personal data is allowed.</p>
</div>
<div id="geocoding" class="section level2">
<h2 class="hasAnchor">
<a href="#geocoding" class="anchor"></a>Geocoding</h2>
<p>You can can geocode your data (obtain latitude and longitude from addresses) via <code><a href="../reference/GPE_geocode.html">GPE_geocode()</a></code>, a function that queries the Google Maps Platform to translate addresses into latitude/longitude coordinates.</p>
<p>Using the Google Maps Platform requires a registered API key. To obtain it, follow instructions from <a href="https://developers.google.com/maps/gmp-get-started" class="uri">https://developers.google.com/maps/gmp-get-started</a>. Make sure you enable the Geocoding API.</p>
<p>A valid API key is a string of leters and numbers that looks like <code>AIjaSyBR76W62lloYPh_c01LYGhCOZuKU6RVW9</code> -this is not a real ID by the way, just an example-. Once you have your key, you can take a data frame with an address column like this one:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(GPE)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">schools</a></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##    name            address                             level               
##    &lt;chr&gt;           &lt;chr&gt;                               &lt;chr&gt;               
##  1 EMus 02         Camarones 4351, C1407FMU, CABA      other               
##  2 Col La Anuncia… Arenales 2065, C1124AAE, CABA       preschool, primary,…
##  3 EPjs 06         Avda. Eva Perón 7431, C1439BTM, CA… primary             
##  4 EPjs 02         Avda. Pte. Manuel Quintana 31/07, … primary             
##  5 Col Horacio Wa… Díaz Colodrero 2431, C1431FMA, CABA preschool, primary,…
##  6 EPjc 21         Pinto 3910, C1429APP, CABA          primary             
##  7 Casa de la Edu… Boulogne Sur Mer 626, C1213AAJ, CA… primary, secondary  
##  8 CFP 06 CIFPA    Avda. Asamblea 153, C1424COB, CABA  secondary           
##  9 EI Pulgarcito   Cerrito 572, C1010AAL, CABA         other               
## 10 Esc de la Paz   Gral. Venancio Flores 65, C1405CGA… preschool, primary,…</code></pre>
<p>…then add latitude and longited columns with GPE_geocode, specifying the name of the address column and your Google Maps Platform API key:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">key &lt;-<span class="st"> "AIjaSyBR76W62lloYPh_c01LYGhCOZuKU6RVW9"</span> <span class="co"># This is not a real API key, provide yours</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="../reference/GPE_geocode.html">GPE_geocode</a></span>(schools, address, key)</a></code></pre></div>
<pre><code>## # A tibble: 10 x 5
##    name          address                      level               lon   lat
##    &lt;chr&gt;         &lt;chr&gt;                        &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt;
##  1 EMus 02       Camarones 4351, C1407FMU, C… other             -58.5 -34.6
##  2 Col La Anunc… Arenales 2065, C1124AAE, CA… preschool, prima… -58.4 -34.6
##  3 EPjs 06       Avda. Eva Perón 7431, C1439… primary           -58.5 -34.7
##  4 EPjs 02       Avda. Pte. Manuel Quintana … primary           -58.4 -34.6
##  5 Col Horacio … Díaz Colodrero 2431, C1431F… preschool, prima… -58.5 -34.6
##  6 EPjc 21       Pinto 3910, C1429APP, CABA   primary           -58.5 -34.5
##  7 Casa de la E… Boulogne Sur Mer 626, C1213… primary, seconda… -58.4 -34.6
##  8 CFP 06 CIFPA  Avda. Asamblea 153, C1424CO… secondary         -58.4 -34.6
##  9 EI Pulgarcito Cerrito 572, C1010AAL, CABA  other             -58.4 -34.6
## 10 Esc de la Paz Gral. Venancio Flores 65, C… preschool, prima… -58.4 -34.6</code></pre>
<p>Columns with latitude and longitude coordinates are added to the original data frame.</p>
</div>
<div id="mapping-geocoded-data" class="section level2">
<h2 class="hasAnchor">
<a href="#mapping-geocoded-data" class="anchor"></a>Mapping geocoded data</h2>
<p>You’ll need a data frame containg participant data.</p>
<p>GPE includes “participants”, an example data frame with fictional public program beneficiaries:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(participants)</a></code></pre></div>
<pre><code>##   participant_id     group income_bracket
## 1           6494 treatment              6
## 2            409   control              6
## 3           6763 treatment              4
## 4            616   control             10
## 5           4650   control              7
## 6            594   control              8
##                                               address       lon       lat
## 1                              LAVALLE Y PARANA, CABA -58.38835 -34.60277
## 2                        HORTIGUERA Y SANTANDER, CABA -58.44152 -34.63677
## 3                              BAZURCO Y CUENCA, CABA -58.51083 -34.58317
## 4 FIGUEROA ALCORTA, PRES. AV. Y SIVORI, EDUARDO, CABA -58.40110 -34.57915
## 5                     AGUIRRE Y ALVAREZ, JULIAN, CABA -58.43369 -34.59969
## 6                               JUNIN Y LAVALLE, CABA -58.39656 -34.60365</code></pre>
<p>The geographic position of participants and program locations can be plotted, on top of a basemap, with:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/GPE_plot_map.html">GPE_plot_map</a></span>(participants)</a></code></pre></div>
<p><img src="using_GPE_files/figure-html/unnamed-chunk-5-1.png" width="1458.33333333333"></p>
<p>In order for <code><a href="../reference/GPE_plot_map.html">GPE_plot_map()</a></code> to work, the input dataframe mus include columns named “lat” and “lon” representing WGS84 coordinates. As reviously shown, latitude and longitude columns can be obtained from addresses using <code><a href="../reference/GPE_geocode.html">GPE_geocode()</a></code></p>
<p>In addtion, a dataframe containing locations -places that participants visit in order to interact with the program, such as training centers, day care providers, etc-. can also be mapped. GPE includes “locations”, an example data frame with fictional public program sites:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(locations)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   location_id type    lon   lat
##         &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1           1 A     -58.4 -34.6
## 2           2 A     -58.4 -34.6
## 3           3 A     -58.4 -34.6
## 4           4 A     -58.4 -34.6
## 5           5 A     -58.4 -34.6
## 6           6 A     -58.4 -34.6</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/GPE_plot_map.html">GPE_plot_map</a></span>(participants, locations)</a></code></pre></div>
<p><img src="using_GPE_files/figure-html/unnamed-chunk-7-1.png" width="1458.33333333333"></p>
<p>You can also visualize participant attributes by indicating the column name for the variable to show:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/GPE_plot_map.html">GPE_plot_map</a></span>(participants, locations, <span class="dt">participant_attribute =</span> <span class="st">"group"</span>)</a></code></pre></div>
<p><img src="using_GPE_files/figure-html/unnamed-chunk-8-1.png" width="1458.33333333333"></p>
<p>Also location attributes…</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/GPE_plot_map.html">GPE_plot_map</a></span>(participants, locations, <span class="dt">location_attribute =</span> <span class="st">"type"</span>)</a></code></pre></div>
<p><img src="using_GPE_files/figure-html/unnamed-chunk-9-1.png" width="1458.33333333333"></p>
<p>… or both participant and location attributes:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/GPE_plot_map.html">GPE_plot_map</a></span>(participants, locations, <span class="dt">participant_attribute =</span> <span class="st">"group"</span>, <span class="dt">location_attribute =</span> <span class="st">"type"</span>)</a></code></pre></div>
<p><img src="using_GPE_files/figure-html/unnamed-chunk-10-1.png" width="1458.33333333333"></p>
</div>
<div id="estimating-travel-distance-and-time" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-travel-distance-and-time" class="anchor"></a>Estimating travel distance and time</h2>
<p>Having records of interaction between people and places -representing trips of consumers/beneficiaries to points of sale/access- time and distance travelled can be estimated by using the Google Maps Platform. As is the case with geocoding, a valid API key is needed to access this service.</p>
<p>GPE provides an example “visits” data frame:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">visits</a></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##    date       participant_id location_id
##    &lt;date&gt;              &lt;dbl&gt;       &lt;dbl&gt;
##  1 2018-07-22           5786          71
##  2 2018-06-29            804           5
##  3 2018-11-08           6880          76
##  4 2018-03-29            834           6
##  5 2018-05-31           2643          67
##  6 2018-09-18           1694          17
##  7 2018-09-04           4852          26
##  8 2018-08-06           2825           9
##  9 2018-08-16           4522          61
## 10 2018-06-12           3395          61</code></pre>
<p>Trip distance and duration can be obtained using <code><a href="../reference/GPE_travel_time_dist.html">GPE_travel_time_dist()</a></code>. The function takes as input visits data, as well as the locations and participants data frames that provide the origin and destination coordinates. A valid Google Maps Platform API key is also required. Transport mode can be choose from “transit” (default), “driving”, “walking”, or “bicycling”. Keep in mind that transit routing information is not available for all cities; “driving” and “walking” routing is usually available everywhere.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/GPE_travel_time_dist.html">GPE_travel_time_dist</a></span>(visits, participants, locations, key)</a></code></pre></div>
<pre><code>##          date participant_id location_id time_minutes distance_km    mode
## 1  2018-03-29            834           6     17.38333       2.317 transit
## 2  2018-05-31           2643          67     39.35000       5.511 transit
## 3  2018-06-12           3395          61     39.80000       8.816 transit
## 4  2018-06-29            804           5     36.20000      10.664 transit
## 5  2018-07-22           5786          71     21.75000       2.303 transit
## 6  2018-08-06           2825           9     31.20000       4.363 transit
## 7  2018-08-16           4522          61     40.30000      10.397 transit
## 8  2018-09-04           4852          26     40.81667       5.293 transit
## 9  2018-09-18           1694          17     66.25000      12.231 transit
## 10 2018-11-08           6880          76     55.16667      11.477 transit</code></pre>
</div>
<div id="summaries" class="section level2">
<h2 class="hasAnchor">
<a href="#summaries" class="anchor"></a>Summaries</h2>
<p>GPE includes a simple summary function that takes a “visits” data frame, as described before, and returns basic descriptive statistics for</p>
<ul>
<li>frecuency of visits, by participant (person)</li>
<li>frecuency of visits, by location (site)</li>
</ul>
<p>If the input data frame includes <code>time_minutes</code> and <code>distance_km</code> columns (i.e. as a result of using <code><a href="../reference/GPE_travel_time_dist.html">GPE_travel_time_dist()</a></code>) the summary will also include basic descriptive statistics for</p>
<ul>
<li>travel time, in minutes</li>
<li>travel distance, in km</li>
</ul>
<p>For example, given a data frame like</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(visits_timedist)</a></code></pre></div>
<pre><code>##   participant_id location_id       date time_minutes distance_km    mode
## 1           1080           1 2018-01-20     35.71667      13.230 transit
## 2           1080          23 2018-09-06     61.91667      14.674 transit
## 3           1080          37 2018-06-12     33.11667      12.675 transit
## 4           1080          37 2018-05-02     33.11667      12.675 transit
## 5           1080          51 2018-04-16     51.06667      15.156 transit
## 6           1080          63 2018-11-23     84.15000      12.917 transit</code></pre>
<p>the result is:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="../reference/GPE_summary.html">GPE_summary</a></span>(visits_timedist)</a></code></pre></div>
<pre><code>## $`visits by participant`
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   4.000   5.750   6.500   7.312   8.250  13.000 
## 
## $`visits by location`
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.000   3.000   4.000   4.255   6.000  10.000 
## 
## $`travel time (minutes)`
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    6.30   29.00   40.16   40.53   50.27  102.17 
## 
## $`travel distance (km)`
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.576   5.122   8.897   9.165  12.921  28.855</code></pre>
</div>
<div id="visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#visualization" class="anchor"></a>Visualization</h2>
<p>…. COMING SOON</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#prerequisites">Prerequisites</a></li>
      <li><a href="#geocoding">Geocoding</a></li>
      <li><a href="#mapping-geocoded-data">Mapping geocoded data</a></li>
      <li><a href="#estimating-travel-distance-and-time">Estimating travel distance and time</a></li>
      <li><a href="#summaries">Summaries</a></li>
      <li><a href="#visualization">Visualization</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by H. Antonio Vazquez Brust.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
