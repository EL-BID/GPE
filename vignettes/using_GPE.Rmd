---
title: "Using GPE"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Using GPE}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, dpi = 300)
```

## Prerequisites

You'll need tabular data with addresses, or "lon" and "lat" columns containing WG84 (Mercator) location coordinates. IE, a table with the addresses of schools were program beneficiaries attend, or a street or centroid identifying their neighboorhoods, or their home addresses -if using personal data is allowed.

## Geocoding

You can can geocode your data (obtain latitude and longitude from addresses) via `GPE_geocode()`, a function that queries the Google Maps Platform to translate addresses into latitude/longitude coordinates. 

Using the Google Maps Platform requires a registered API key. To obtain it, follow instructions from  https://developers.google.com/maps/gmp-get-started. Make sure you enable the Geocoding API.

A valid API key is a string of leters and numbers that looks like `AIjaSyBR76W62lloYPh_c01LYGhCOZuKU6RVW9` -this is not a real ID by the way, just an example-. Once you have your key, you can take a data frame with an address column like this one:

```{r}
library(GPE)

schools
```

...then add latitude and longited columns with GPE_geocode, specifying the name of the address column and your Google Maps Platform API key:

```{r eval=FALSE}
key <- "AIjaSyBR76W62lloYPh_c01LYGhCOZuKU6RVW9" # This is not a real API key, provide yours

GPE_geocode(schools, address, key)
```

```{r echo=FALSE}
key <- ggmap::google_key()

GPE_geocode(schools, address, key)
```


## Mapping geocoded data

You'll need a data frame containg participant data. 

GPE includes "participants", an example data frame with fictional public program beneficiaries:

```{r}
head(participants)
```



The geographic position of participants and program locations can be plotted, on top of a basemap, with:

```{r}
GPE_plot_map(participants)
```

If you also have a dataframe containing locations -places that participants visit in order to interact with the program, such as training centers, day care providers, etc-. you can also map it. GPE includes "locations", an example data frame with fictional public program sites:

```{r}
head(locations)
```

```{r}
GPE_plot_map(participants, locations)
```

## Estimating travel distance and time


```{r}

```

